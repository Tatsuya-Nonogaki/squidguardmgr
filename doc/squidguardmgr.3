.\" Automatically generated by Pod::Man 2.22 (Pod::Simple 3.13)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SQUIDGUARDMGR 1"
.TH SQUIDGUARDMGR 1 "2013-11-26" "perl v5.10.1" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
SquidGuard Manager \- Web GUI for SquidGuard and SquidClamav administration
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
SquidGuard Manager is a Perl \s-1CGI\s0 Web \s-1GUI\s0 for squidGuard and SquidClamav administration. It allows full management of SquidGuard blocklist and ACLs. You can also manage graphicaly your SquidClamav configuration.
.PP
This program supports all configuration directives of SquidGuard and SquidClamav
without intrusive modification, i\-e you can still edit the configuration files
by hand before and after using SquidGuard Manager.
.SH "FEATURES"
.IX Header "FEATURES"
.SS "SquidGuard Manager \s-1GUI\s0 interfaces"
.IX Subsection "SquidGuard Manager GUI interfaces"
.IP "Globals" 4
.IX Item "Globals"
This interface allows you to define SquidGuard global variables.
.IP "Schedules" 4
.IX Item "Schedules"
This interface allows you to define schedules time in order to use in other
SquidGuard objects (Sources, \s-1URL\s0 Rewrites, Filters and ACLs).
.IP "Sources" 4
.IX Item "Sources"
Use this interface to define sources like users, groups, Ip addresses, range
of Ip addresses or networks to apply policies on. These can be issued from a
list, a file, an ldap query, a mysql query or a command line utility.
.IP "Url rewriting" 4
.IX Item "Url rewriting"
This interface allows you to define \s-1URL\s0 rewriting groups, each consists of
one or more Sed style substitution rules. They can be applied to source groups
in ACLs menu.
.IP "Filters" 4
.IX Item "Filters"
Destination Groups filter selector in other words. In this interface you can
shape each group by selecting a list for domain, url or regexp filter from
those you defined in Manage Lists interface.
.IP "ACLs" 4
.IX Item "ACLs"
This is the central place where you define what source objects follow what
filters and when. Here everything fits together.
.IP "View Configuration" 4
.IX Item "View Configuration"
This interface allows you to see the SquidGuard configuration file.
.IP "Manage Lists" 4
.IX Item "Manage Lists"
This interface allows you to build blocklists for each destination group.
You can edit a whole list or add/remove individual entries.
.IP "View logs" 4
.IX Item "View logs"
This menu allows you to consult all log files in the log directory you'd
defined in the SquidGuard global configuration.
.IP "SquidClamav" 4
.IX Item "SquidClamav"
This link leads you to the \s-1GUI\s0 interface to administer SquidClamav configuration
file. This interface is enabled only if you have SquidClamav installed on your
system.
.IP "Restart Squid" 4
.IX Item "Restart Squid"
This link allows you to 'reconfigure' or quick-restart Squid to make it
recognize the changes you made to SquidGuard and/or SquidClamav configuration.
.SS "SquidClamav Manager \s-1GUI\s0 interfaces"
.IX Subsection "SquidClamav Manager GUI interfaces"
Since release 1.4 SquidClamav Manager is able to manage both SquidClamav v5.x
and v6.x branch.
.IP "Globals" 4
.IX Item "Globals"
This interface allows you to manage SquidClamav global variables.
.IP "Virus Scanning" 4
.IX Item "Virus Scanning"
This interface allows you to exclude \s-1URL\s0 or Content-Type from virus scan by
defining regexp patterns.
.IP "Whitelists" 4
.IX Item "Whitelists"
Use this interface to define which domain name or site hostname to be
whitelisted, i\-e there happens no virus scan nor call to SquidGuard on these
sites.
.IP "Trusted Users" 4
.IX Item "Trusted Users"
Use this interface to define which users (\s-1RFC\-931\s0 usernames) will be excluded
from virus scan and SquidGuard blocklists.
.IP "Trusted Clients" 4
.IX Item "Trusted Clients"
Use this interface to define which client hostnames or ip addresses will be
excluded from virus scan and SquidGuard blocklists.
.IP "View Configuration" 4
.IX Item "View Configuration"
This interface allows you to see the SquidClamav configuration file.
.IP "View log" 4
.IX Item "View log"
This interface allows you to consult the SquidClamav log file.
.PP
In resume SquidGuard Manager is capable of every configuration task on
SquidGuard and SquidClamav which otherwise you have to perform by opening
terminal, editing files, becoming root and running commands manually.
Modifications are written immediately to the configuration files.
.SH "REQUIREMENT"
.IX Header "REQUIREMENT"
SquidGuard Manager may run on any Unix like \s-1OS\s0 with any modern Perl installation
using the perl \s-1CGI\s0 module. It must be run on a proxy server hosting squidGuard.
.PP
You need to run this \s-1CGI\s0 script using Apache \s-1HTTP\s0 server. And the httpd daemon
must be run as uid and gid holding SquidGuard (most of the time this is
squid cache effective user/group). This is to allow SquidGuard Manager to read
and write into the configuration files to manage blocklists and acls. If you
use SquidClamav, it must be run under the same user too.
.PP
SquidGuard Manager uses some system commands to manage blocklists and log files.
Your system must have the following binaries installed: diff, grep, find, rm
and tail.
.SH "INSTALLATION"
.IX Header "INSTALLATION"
To install SquidGuard Manager you must be able to gain root privilege so
that installer script can put files with appropriate permission.
.SS "Prepare your system"
.IX Subsection "Prepare your system"
SquidGuard Manager need to have read/write access onto SquidGuard configuration
file and the dbhome directory. It must also have read rights onto the log file.
If you use the SquidClamav Manager \s-1GUI\s0 it also need read/write access on the
squidclamav.conf file as well as the log file.
.PP
For that reason SquidGuard Manager must be run as the user under which
SquidGuard and SquidClamav are run. Most of the time this is the Squid cache
effective user.
.PP
.Vb 3
\&        chown \-R squid:squid /usr/local/squidGuard
\&or
\&        chown \-R squid:squid /etc/squidguard.conf /var/lib/squidguard
.Ve
.PP
To allow httpd to run squidguardmgr.cgi as appropriate user/group you must
edit your httpd.conf file and set the User and Group directives to the user
and group running Squid.
.PP
After configuration changes squid ought to be 'reconfigure'd, in other words
quick-restarted. SquidGuard Manager Web \s-1GUI\s0 does it by using a 'setuid root'ed
wrapper. If your system doesn't support the feature unfortunately, you may need
to do that by hand.
.PP
\&\s-1IMPORTANT:\s0 SquidGuard Manager doesn't support symbolic links in the SquidGuard
dbhome directory. If it is your case, you need to remove those symbolic links
and modify your squidguard.conf file  so that points the real files and
directories.
.SS "Automatic installation"
.IX Subsection "Automatic installation"
Execute the install script and answer to some questions it ask:
.PP
.Vb 4
\&        $ perl Makefile.PL
\&        $ make
\&        $ su
\&        # make install
.Ve
.PP
By default it will install all files into /var/www/squidguardmgr/ and show you
a configuration sample that should be included in your httpd.conf. Also, you
can find some Apache configuration samples in contrib/ directory of the
SquidGuard Manager source repository. Once you have done, restart httpd server
and take a look at http://my.proxy.dom/squidguardmgr/ or 
http://my.proxy.dom:port/squidguardmgr/
.PP
You can fully customize this installation by passing the following variables
to Makefile.PL:
.PP
.Vb 10
\&        CONFFILE => Absolute path to the SquidGuard configuration file
\&        DBHOME => Absolute path to the SquidGuard DB directory
\&        LOGDIR => Absolute path to the SquidGuard log directory
\&        WWWDIR => Absolute path to the SquidGuard Manager base installation
\&                  directory
\&        CGIDIR => Relative path from WWWDIR to install CGI script.
\&                  Default equals WWWDIR
\&        HTMLDIR => Relative path from WWWDIR to install css, js and
\&                   image files. Default equals WWWDIR
\&        LANGDIR => Translation language to use (en_US or fr_FR).
\&                   Default: en_US
\&        BASEURL => Path part of the base url to access SquidGuard
\&                   Manager Web GUI. Default: /squidguardmgr
\&        SQUIDUSR => User running Squid
\&        SQUIDGRP => Group running Squid
\&        SQUIDCLAMAV => Absolute path to the squidclamav binary (v5.x only)
\&        CICAP_SOCKET => c\-icap server control socket (v6.x only)
\&        SQUIDCLAMAVCONF => Absolute path to squidclamav.conf file
.Ve
.PP
For packaging there's two more configuration variables:
.PP
.Vb 2
\&        DESTDIR => Directory prefix wher install will be done
\&        QUIET => Do not display the post install message
.Ve
.PP
Example:
.PP
.Vb 10
\&        perl Makefile.PL \e
\&        CONFFILE=/usr/local/etc/squidguard.conf \e
\&        DBHOME=/usr/local/squidguard/db \e
\&        LOGDIR=/usr/local/logs/squidguard \e
\&        WWWDIR=/usr/local/apache \e
\&        CGIDIR=cgi\-bin/admin HTMLDIR=htdocs/admin \e
\&        LANGDIR=fr_FR BASEURL=/admin \e
\&        SQUIDUSR=squid SQUIDGRP=squid \e
\&        SQUIDCLAMAV=/usr/local/bin/squidclamav \e
\&        SQUIDCLAMAVCONF=/etc/squidclamav.conf
\&
\&        make
\&        su
\&        make install
.Ve
.PP
This will install SquidGuard Manager \s-1CGI\s0 squidguardmgr.cgi, squidguardmgr.conf,
squid_wrapper and all language files under /usr/local/apache/cgi\-bin/admin/. All
SquidGuard Manager css, js and images files will be copied under the directory
/usr/local/apache/htdocs/admin/. Squidguard Manager will expect to find the
SquidGuard configuration file at /usr/local/etc/squidguard.conf and the log
and SquidGuard databases respectively at /usr/local/logs/squidguard and
/usr/local/squidguard/db. All the installed files will be owned by user squid
and group squid. The squid wrapper (use to reconfigure squid after change)
will be setuid root.
.SS "Manual installation"
.IX Subsection "Manual installation"
Copy all files from the cgi-bin repository into the \s-1CGI\s0 script directory of
your choice. Check that squidguardmgr.cgi can be executable by your Apache
server and chown the entire directory to the user and group running httpd.
.PP
Copy all files from the htdocs repository into your DocumentRoot directory or
any other subdirectory and check that they can be read by your httpd server.
.PP
Edit the squidguardmgr.conf file into your cgi directory and check that all
paths conforms to your installation.
.PP
If you want to be able to reload Squid redirector from the \s-1GUI\s0 interface after
your SquidGuard and/or SquidClamav modification, you must compile and install
the squid_wrapper with suid root into the squidguardmgr.cgi directory.
.PP
Before compilation you may need to edit squid_wrapper.c and change the
\&\s-1SQUID_BINARY\s0 definition to point correctly to your squid binary.
.PP
Then as root:
.PP
.Vb 5
\&        cd squid_wrapper/
\&        cc \-o /path/squidguardmgr/cgi/squid_wrapper squid_wrapper.c
\&        chown root.root /path/squidguardmgr/cgi/squid_wrapper
\&        chmod 755 /path/squidguardmgr/cgi/squid_wrapper
\&        chmod u+s /path/squidguardmgr/cgi/squid_wrapper
.Ve
.SH "CONFIGURATION"
.IX Header "CONFIGURATION"
SquidGuard Manager needs some configuration. They are stored in the
squidguardmgr.conf file. During the automatic installation this file
will be generated automatically.
.IP "\s-1SQUIDGUARD\s0    /usr/local/squidGuard/bin/squidGuard" 4
.IX Item "SQUIDGUARD    /usr/local/squidGuard/bin/squidGuard"
This directive allows you to configure the path to the SquidGuard program. If
you set it to off or no, the SquidGuard Manager interface will be disabled and
it will only show the SquidClamav Manager interface.
.IP "\s-1CONF_FILE\s0     /usr/local/squidGuard/squidguard.conf" 4
.IX Item "CONF_FILE     /usr/local/squidGuard/squidguard.conf"
Configure the path to the SquidGuard configuration file.
.IP "\s-1SQUIDCLAMAV\s0   /usr/bin/squidclamav | c\-icap" 4
.IX Item "SQUIDCLAMAV   /usr/bin/squidclamav | c-icap"
Path to the SquidClamav program when using SquidClamav v5.x branch and must be
set to 'c\-icap' when you're using v6.x branch.
.IP "C_ICAP_SOCKET   /var/run/c\-icap/c\-icap.ctl" 4
.IX Item "C_ICAP_SOCKET   /var/run/c-icap/c-icap.ctl"
Path to the c\-icap control socket. Used by SquidClamav Manager to reconfigure
the c\-icap server to apply SquidClamav configuration changes. Used only with
SquidClamav 6.x branch.
.IP "\s-1SC_CONF_FILE\s0  /etc/squidclamav.conf" 4
.IX Item "SC_CONF_FILE  /etc/squidclamav.conf"
Path to the SquidClamav configuration file.
.IP "\s-1LANG\s0          en_US" 4
.IX Item "LANG          en_US"
Used to set the language, default is en_US.
Current available \s-1LANGS\s0 are: en_US, fr_FR.
.IP "\s-1SQUID_WRAPPER\s0 /var/www/squidguargmgr/squid_wrapper" 4
.IX Item "SQUID_WRAPPER /var/www/squidguargmgr/squid_wrapper"
Command wrapper to reload Squid. Why you need this wrapper is because only root
can do it. This wrapper will execute the following system command as root user:
.Sp
.Vb 1
\&        /path/to/squid/bin/squid \-k reconfigure
.Ve
.IP "\s-1IMG_DIR\s0      /squidguargmgr/images" 4
.IX Item "IMG_DIR      /squidguargmgr/images"
Path part of SquidGuard Manager \s-1URL\s0 where images are found.
.IP "\s-1CSS_FILE\s0     /squidguargmgr/squidguardmgr.css" 4
.IX Item "CSS_FILE     /squidguargmgr/squidguardmgr.css"
SquidGuard Manager \s-1URL\s0 to point to the Style Sheet(\s-1CSS\s0) file.
.IP "\s-1JS_FILE\s0      /squidguargmgr/squidguardmgr.js" 4
.IX Item "JS_FILE      /squidguargmgr/squidguardmgr.js"
SquidGuard Manager \s-1URL\s0 which points to Javascript(js) file.
.IP "\s-1LOG_LINES\s0   1000" 4
.IX Item "LOG_LINES   1000"
Number of last lines out of log files to display.
.IP "\s-1DNSBL\s0        your.preferred.blacklist.com,other.preferred.blacklist.com" 4
.IX Item "DNSBL        your.preferred.blacklist.com,other.preferred.blacklist.com"
Comma separated list of \s-1DNS\s0 Blacklists. If you have SquidGuard 1.5 or above put
here the DNSBLs you want to use.
.IP "\s-1TAIL\s0, \s-1FIND\s0, \s-1DIFF\s0, \s-1RM\s0, \s-1GREP\s0" 4
.IX Item "TAIL, FIND, DIFF, RM, GREP"
These optional configuration directives are used to override the default path
to the system commands /usr/bin/tail, /usr/bin/find, /usr/bin/diff, /usr/bin/rm
and /usr/bin/grep.
.IP "\s-1KEEP_DIFF\s0" 4
.IX Item "KEEP_DIFF"
This enables record of added/removed items from squidGuard blacklists in diff
files which can be used to recover changes after a fresh download of blacklists.
Default value is 1, enabled. Set it to 0 to disable this feature.
.SH "AUTHORS"
.IX Header "AUTHORS"
Gilles Darold <gilles \f(CW@nospam\fR@ darold.net>
.PP
Tatsuya Nonogaki <winfield \f(CW@nospam\fR@support.email.ne.jp>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2010\-2013 Gilles Darold \- All rights reserved.
.PP
.Vb 4
\&        This program is free software: you can redistribute it and/or modify
\&        it under the terms of the GNU General Public License as published by
\&        the Free Software Foundation, either version 3 of the License, or
\&        any later version.
\&
\&        This program is distributed in the hope that it will be useful,
\&        but WITHOUT ANY WARRANTY; without even the implied warranty of
\&        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
\&        GNU General Public License for more details.
\&
\&        You should have received a copy of the GNU General Public License
\&        along with this program.  If not, see < http://www.gnu.org/licenses/ >.
.Ve
.SH "BUGS"
.IX Header "BUGS"
Your volonteer to help construct a better software by submitting bug report or
feature request as well as code contribution are welcome.
