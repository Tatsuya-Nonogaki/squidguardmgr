.\" Automatically generated by Pod::Man 2.25 (Pod::Simple 3.16)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SQUIDGUARDMGR 1"
.TH SQUIDGUARDMGR 1 "2013-11-20" "perl v5.14.2" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
SquidGuard Manager \- Web GUI for squidGuard and SquidClamav administration
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
SquidGuard Manager is a Perl \s-1CGI\s0 Web \s-1GUI\s0 for squidGuard and SquidClamav administration. It allow full management of SquidGuard blocklist and ACLs. You can also manage graphicaly your SquidClamav configuration.
.PP
This program support all configurations directives of SquidGuard and SquidClamav
without intrusive modification, i\-e you can still edit the configuration files
by hand before and after using SquidGuard Manager.
.SH "FEATURES"
.IX Header "FEATURES"
.SS "SquidGuard Manager \s-1GUI\s0 interfaces"
.IX Subsection "SquidGuard Manager GUI interfaces"
.IP "Globals" 4
.IX Item "Globals"
This interface allow you to define SquidGuard globals variables.
.IP "Schedules" 4
.IX Item "Schedules"
This interface allow you to define schedules time to be used in other SquidGuard
object (Sources, \s-1URL\s0 Rewrites, Filters and ACLs).
.IP "Sources" 4
.IX Item "Sources"
Use this interface to define sources like users, groups, Ip addresses, range of
Ip addresses or networks to apply policies on them. These can be issued from a
list, a file, an ldap query, a mysql query or a command line utility.
.IP "Url rewriting" 4
.IX Item "Url rewriting"
This interface allow you to define as many as \s-1URL\s0 rewriting rules that you want
\&. They will be applied by SquidGuard following regex pattern matching.
.IP "Filters" 4
.IX Item "Filters"
This interface allow you to defined \s-1URL\s0 destination groups based on predefined
lists of domain, url or regexp expressions.
.IP "ACLs" 4
.IX Item "ACLs"
This is the central place where you defined your access rules to apply to the
different source object following the defined filter destination
.IP "View Configuration" 4
.IX Item "View Configuration"
This interface allow you to see the SquidGuard configuration file.
.IP "Manage Lists" 4
.IX Item "Manage Lists"
This interface allow you to manage all lists by editing them fully or adding,
removing and searching entries.
.IP "Logs" 4
.IX Item "Logs"
This interface allow you to consult all log files you have defined in the
SquidGuard object configuration.
.IP "SquidClamav" 4
.IX Item "SquidClamav"
Links you to a \s-1GUI\s0 interface to administer SquidClamav configuration file.
This interface is enable only if you have SquidClamav installed on the system.
.IP "Restart Squid" 4
.IX Item "Restart Squid"
This link allow you to 'reconfigure' Squid when changes to SquidGuard and/or
SquidClamav redirectors configuration files are done.
.SS "SquidClamav Manager \s-1GUI\s0 interfaces"
.IX Subsection "SquidClamav Manager GUI interfaces"
Since release 1.4 SquidClamav Manager is able to manage both Squidclamav v5.x
and v6.x branch.
.IP "Globals" 4
.IX Item "Globals"
This interface allow you to manage SquidClamav globals variables.
.IP "Virus Scanning" 4
.IX Item "Virus Scanning"
This interface allow you to desactivate virus scan based on regex pattern on
\&\s-1URL\s0 or Content-Type.
.IP "Whitelists" 4
.IX Item "Whitelists"
Use this interface to define which domain name or site hostname to whitelist,
i\-e there will be no virus scan nor call to SquidGuard on these sites.
.IP "Trusted Users" 4
.IX Item "Trusted Users"
Use this interface to define which users (\s-1RFC\-931\s0 usernames) will be excluded
from virus scan and SquidGuard blocklists.
.IP "Trusted Clients" 4
.IX Item "Trusted Clients"
Use this interface to define which client hostnames or ip addresses will be
excluded from virus scan and SquidGuard blocklists.
.IP "View Configuration" 4
.IX Item "View Configuration"
This interface allow you to see the SquidClamav configuration file.
.IP "View log" 4
.IX Item "View log"
This interface allow you to consult the SquidClamav log file.
.PP
In resume you can do all you're doing by hand in dedicated \s-1HTML\s0 interfaces,
modification are written immediatly to configuration files.
.SH "REQUIREMENT"
.IX Header "REQUIREMENT"
SquidGuard Manager may run on any Unix like \s-1OS\s0 with any modern Perl installation
using the perl \s-1CGI\s0 module. It must be run on a proxy server hosting squidGuard.
.PP
You need to run this \s-1CGI\s0 script using Apache \s-1HTTP\s0 server and the httpd daemon
must run be run as uid and gid holding SquidGuard (most of the time this is
squid cache effective user/group). This is to allow SquidGuard Manager to read
and write into the configuration files to manage blocklists and acls. If you
use SquidClamav, it must also be run under the same user.
.PP
SquidGuard Manager use some system commands to manage blocklists and log files.
Your system must have the following binariesi installed: diff, grep, find, rm
and tail.
.SH "INSTALLATION"
.IX Header "INSTALLATION"
To install SquidGuard Manager you must be root as you need to set specials
grants on the filesystem.
.SS "Prepare your system"
.IX Subsection "Prepare your system"
SquidGuard Manager need to have read/write access onto SquidGuard configuration
file and the dbhome directory. It also must have read access onto the log file.
If you use the SquidClamav Manager \s-1GUI\s0 it also need read/write access on the
squidclamav.conf file as well as the log file.
.PP
For that SquidGuard Manager must be run as the user under which squidguard and
squidclamav are run. Most of the time this is the Squid cache effective user.
.PP
.Vb 3
\&        chown \-R squid:squid /usr/local/squidGuard
\&or
\&        chown \-R squid:squid /etc/squidguard.conf /var/lib/squidguard
.Ve
.PP
To allow httpd to run squidguardmgr.cgi as a different user or group you must
edit your httpd.conf file and change the User/Group directive to the user and
group running Squid.
.PP
To be able to reconfigure squid after configuration change from the web \s-1GUI\s0
SquidGuard Manager use a setuid wrapper as root user. So you system may support
this feature or will need to do that by hand.
.PP
\&\s-1IMPORTANT:\s0 SquidGuard Manager do not support symbolic link into the SquidGuard
dbhome directory. You need to remove these symbolic links from your system and
modify your squidguard.conf file to replace them by the directories real names.
.SS "Automatic installation"
.IX Subsection "Automatic installation"
Execute the install script and answer to the questions as follow:
.PP
.Vb 2
\&        perl Makefile.PL
\&        make && make install
.Ve
.PP
By default it will install all files into /var/www/squidguardmgr/ and give
you a configuration sample to include in your httpd.conf. After that restart
your httpd server and take a look at http://my.proxy.dom/squidguardmgr/
.PP
You can fully customize this installation by using the following variables:
.PP
.Vb 10
\&        CONFFILE => Where is the SquidGuard configuration file
\&        DBHOME => Where is the SquidGuard DB directory
\&        LOGDIR => Where is the SquidGuard log directory
\&        WWWDIR => SquidGuard Manager base directory installation
\&        CGIDIR => Where to install CGI: WWWDIR/CGIDIR. Default: WWWDIR
\&        HTMLDIR =>  Where to install css,js and images files: WWWDIR/HTMLDIR. Default: WWWDIR
\&        LANGDIR => Translation directory to use (en_US or fr_FR). Default: en_US
\&        BASEURL => Base url where css,js and images files will be found. Default: /squidguardmgr
\&        SQUIDUSR => User running Squid
\&        SQUIDGRP => Group running Squid
\&        SQUIDCLAMAV => Path to squidclamav binary (v5.x only)
\&        CICAP_SOCKET => c\-icap server control socket (v6.x only)
\&        SQUIDCLAMAVCONF => Path to squidclamav.conf file
.Ve
.PP
For packaging there's two more configuration variables:
.PP
.Vb 2
\&        DESTDIR => Directory prefix wher install will be done
\&        QUIET => Do not display the post install message
.Ve
.PP
Example:
.PP
.Vb 7
\&        perl Makefile.PL CONFFILE=/usr/local/etc/squidguard.conf \e
\&        DBHOME=/usr/local/squidguard/database \e
\&        LOGDIR=/usr/local/logs/squidguard \e
\&        WWWDIR=/usr/local/apache CGIDIR=cgi\-bin/admin HTMLDIR=htdocs/admin \e
\&        LANGDIR=fr_FR BASEURL=/admin/ SQUIDUSR=squid SQUIDGRP=squid \e
\&        SQUIDCLAMAV=/usr/local/bin/squidclamav \e
\&        SQUIDCLAMAVCONF=/etc/squidclamav.conf
\&
\&        make && make install
.Ve
.PP
This will install SquidGuard Manager \s-1CGI\s0 squidguardmgr.cgi, squidguardmgr.conf,
squid_wrapper and all language files under /usr/local/apache/cgi\-bin/admin/. All
SquidGuard Manager css, js and images files will be copied under the directory
/usr/local/apache/htdocs/admin/. Squidguard Manager will expect to find the
SquidGuard configuration file at /usr/local/etc/squidguard.conf and the log
and SquidGuard databases respectively at /usr/local/logs/squidguard and
/usr/local/squidguard/database. All installed files will be owned by the squid
user and squid group. The squid wrapper (use to reconfigure squid after change)
will be setuid as root user.
.SS "Manual installation"
.IX Subsection "Manual installation"
Copy all files from the cgi-bin repository into the \s-1CGI\s0 script directory of
your choice. Check that squidguardmgr.cgi can be executable by your Apache
server and chown the entire directory to the user and group running httpd.
.PP
Copy all files from the htdocs repository into your DocumentRoot directory or
any other subdirectory and check that they can be read by your httpd server.
.PP
Edit the squidguardmgr.conf file into you cgi directory and check that all path
are conform to your installation.
.PP
If you want to be able to reload Squid redirector from the \s-1GUI\s0 interface after
your SquidGuard and/or SquidClamav modification, you must compile and install
the squid_wrapper with suid root into the squidguardmgr.cgi repository:
.PP
.Vb 4
\&        cd squid_wrapper/
\&        cc \-o /path/squidguardmgr/cgi/squid_wrapper squid_wrapper.c
\&        chown root.root /path/squidguardmgr/cgi/squid_wrapper
\&        chmod +s /path/squidguardmgr/cgi/squid_wrapper
.Ve
.PP
Before that you must edit squid_wrapper.c and change the path to squid binary.
.SH "CONFIGURATION"
.IX Header "CONFIGURATION"
SquidGuard Manager need some configuration informations. They are stored into
the squidguardmgr.conf file. During the automatic installation this file is
self generated.
.IP "\s-1SQUIDGUARD\s0    /usr/local/squidGuard/bin/squidGuard" 4
.IX Item "SQUIDGUARD    /usr/local/squidGuard/bin/squidGuard"
This directive allow you to configure the path to the SquidGuard program. If you
set it to off or no, the SquidGuard Manager interface will be disabled and it
will only show the SquidClamav Manager interface.
.IP "\s-1CONF_FILE\s0     /usr/local/squidGuard/squidguard.conf" 4
.IX Item "CONF_FILE     /usr/local/squidGuard/squidguard.conf"
Configure the path to the SquidGuard configuration file.
.IP "\s-1SQUIDCLAMAV\s0   /usr/bin/squidclamav | c\-icap" 4
.IX Item "SQUIDCLAMAV   /usr/bin/squidclamav | c-icap"
Path to the SquidClamav program when using SquidClamav v5.x branch and must be
set to 'c\-icap' when you're using v6.x branch.
.IP "C_ICAP_SOCKET   /var/run/c\-icap/c\-icap.ctl" 4
.IX Item "C_ICAP_SOCKET   /var/run/c-icap/c-icap.ctl"
Path to the c\-icap control socket. Used by SquidClamav Manager to reconfigure
the c\-icap server to apply SquidClamav configuration changes. Used only with
SquidClamav 6.x branch.
.IP "\s-1SC_CONF_FILE\s0  /etc/squidclamav.conf" 4
.IX Item "SC_CONF_FILE  /etc/squidclamav.conf"
Path to the SquidClamav configuration file.
.IP "\s-1LANG\s0          en_US" 4
.IX Item "LANG          en_US"
Used to set the language, default is en_US.
Current translation are: en_US, fr_FR.
.IP "\s-1SQUID_WRAPPER\s0 /var/www/squidguargmgr/squid_wrapper" 4
.IX Item "SQUID_WRAPPER /var/www/squidguargmgr/squid_wrapper"
Command wrapper to reload Squid. You must use this wrapper as squid can only
be reload as root. This wrapper will execute the following system command as
root user: /usr/local/squid/sbin/squid \-k reconfigure
.IP "\s-1IMG_DIR\s0      /squidguargmgr/images" 4
.IX Item "IMG_DIR      /squidguargmgr/images"
SquidGuard Manager base \s-1URL\s0 where images are stored.
.IP "\s-1CSS_FILE\s0     /squidguargmgr/squidguardmgr.css" 4
.IX Item "CSS_FILE     /squidguargmgr/squidguardmgr.css"
SquidGuard Manager Style Sheet \s-1CSS\s0 \s-1URL\s0.
.IP "\s-1JS_FILE\s0      /squidguargmgr/squidguardmgr.js" 4
.IX Item "JS_FILE      /squidguargmgr/squidguardmgr.js"
SquidGuard Manager Javascript \s-1URL\s0.
.IP "\s-1LOG_LINES\s0   1000" 4
.IX Item "LOG_LINES   1000"
Number of last lines displayed from log files.
.IP "\s-1DNSBL\s0        your.preferred.blacklist.com,other.preferred.blacklist.com" 4
.IX Item "DNSBL        your.preferred.blacklist.com,other.preferred.blacklist.com"
Comma separated list of \s-1DNS\s0 Blacklists if you have SquidGuard 1.5 or more put
here the \s-1DNSBL\s0 you want to use.
.IP "\s-1TAIL\s0, \s-1FIND\s0, \s-1DIFF\s0, \s-1RM\s0, \s-1GREP\s0" 4
.IX Item "TAIL, FIND, DIFF, RM, GREP"
These optionals configuration directives are used to overide the default path
to the system commands /usr/bin/tail, /usr/bin/find, /usr/bin/diff, /usr/bin/rm
and /usr/bin/grep.
.IP "\s-1KEEP_DIFF\s0" 4
.IX Item "KEEP_DIFF"
Allow keeping added/removed items from squidGuard blocklists as diff files
to be able to recover changes after a fresh download of blocklists. Default
value is 1, enabled. To disable this feature set it to 0.
.SH "AUTHOR"
.IX Header "AUTHOR"
Gilles Darold <gilles \f(CW@nospam\fR@ darold.net>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2010\-2013 Gilles Darold \- All rights reserved.
.PP
.Vb 4
\&        This program is free software: you can redistribute it and/or modify
\&        it under the terms of the GNU General Public License as published by
\&        the Free Software Foundation, either version 3 of the License, or
\&        any later version.
\&
\&        This program is distributed in the hope that it will be useful,
\&        but WITHOUT ANY WARRANTY; without even the implied warranty of
\&        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
\&        GNU General Public License for more details.
\&
\&        You should have received a copy of the GNU General Public License
\&        along with this program.  If not, see < http://www.gnu.org/licenses/ >.
.Ve
.SH "BUGS"
.IX Header "BUGS"
Your volontee to help construct a better software by submitting bug report or
feature request as well as code contribution are welcome.
